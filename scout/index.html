<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>ViperScout</title>

    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600italic,600,700italic,700,800italic,800">
    <link rel="stylesheet" type="text/css" href="./styles.css">
    <script type="text/javascript" src="dist/sorttable.js"></script>
  </head>

  <body class="w3-padding-64">

    <!-- Icon Bar (hidden on small screens) -->
    <div class="w3-top w3-bar w3-light-grey w3-xlarge w3-hide-small">
      <a href="/" class="w3-bar-item w3-button w3-mobile viper-black" id="home_button">
        <i class="fa fa-home" alt="Home"></i>
      </a>
      <div class="w3-bar-item w3-mobile w3-center">
        ViperScout
      </div>
      <a href="#" class="w3-bar-item w3-button w3-mobile w3-right viper-black-hover" id="questions_button">
        <i class="fa fa-question-circle" alt="Questions?"></i>
      </a>
    </div>

    <!-- Navbar on small screens (Hidden on medium and large screens) -->
    <div class="w3-top w3-light-grey w3-hide-large w3-hide-medium" id="myNavbar">
      <div class="w3-bar w3-center w3-large">
        <a href="/" class="w3-bar-item w3-button viper-black" style="width:25% !important" id="home_button"><i class="fa fa-home" alt="Home"></i></a>
        <div class="w3-bar-item w3-center">ViperScout</div>
      </div>
    </div>

    <!-- Page Content -->
    <div class="w3-padding-large" id="main">
      
      <!-- Questions pop-up -->
      <div id="questions_alert" class="w3-content w3-justify w3-panel arm-gray-no-hover w3-display-container w3-animate-opacity" style="display: none;">
        <span onclick="this.parentElement.style.display='none'"
        class="w3-button w3-xlarge arm-red-hover w3-display-topright">&times;</span>
        <h3>Questions or comments?</h3>
        <p>Please contact Michael Ray at <a href="mailto:michael.ray@viperbotsvalor6800.com" target="_top">michael.ray@viperbotsvalor6800.com</a></p>
      </div>

      <!-- Container for the inventory list -->
      <div class="w3-content w3-justify w3-text-white" id="regional_list">

        <!-- Search box -->
        <input class="w3-input w3-border w3-padding search-box" type="text" placeholder="Search regional name, week, location" id="filter_box" onkeyup="filter_results()">

        <!-- Item table -->
          <table class="sortable w3-card w3-table w3-striped w3-hoverable w3-margin-top" id="regional_table">
            <!--Generated items will go here-->
          </table>
      </div>

      <!-- Container for the item content viewer -->
      <div class="w3-content w3-justify w3-card w3-white" id="regional_details" style="display: none;">
        <header class="w3-container viper-black-no-hover">
          <h3><span id="item_details_name"></span></h3>
        </header>

        <!-- Details -->
        <div class="w3-container" id="item_details">
          <img src="https://umexpert.um.edu.my/Avatar/no-image-found.jpg" style="width:150px;" class="w3-left w3-circle">
          <h5><b>Vendor: </b><span id="item_details_vendor"></span></h5>
          <h5><b>Family: </b><span id="item_details_family"></span></h5>
          <h5><b>Description: </b><span id="item_details_description"></span></h5>
          <h5><b>Availability: </b><span id="item_availability"></span></h5>
        </div>
        <!-- Checkout log table -->
        <div class="w3-container w3-padding-16">
          <h3>Checkout log</h3>

          <!-- Check-in button error pop-ups -->
          <div id="checkin_error_alert" class="w3-content w3-justify w3-panel arm-red-no-hover w3-display-container w3-animate-opacity" style="display: none;">
            <span onclick="this.parentElement.style.display='none'"
            class="w3-button w3-xlarge arm-gray-hover w3-display-topright">&times;</span>
            <h3>Check-in Error</h3>
            <p>Cannot check-in more items than are currently checked out.</p>
          </div>
          <div id="checkin_negative_error_alert" class="w3-content w3-justify w3-panel arm-red-no-hover w3-display-container w3-animate-opacity" style="display: none;">
            <span onclick="this.parentElement.style.display='none'"
            class="w3-button w3-xlarge arm-gray-hover w3-display-topright">&times;</span>
            <h3>Check-in Error</h3>
            <p>Cannot check-in a negative number of items.</p>
          </div>
          <div id="checkin_integer_error_alert" class="w3-content w3-justify w3-panel arm-red-no-hover w3-display-container w3-animate-opacity" style="display: none;">
            <span onclick="this.parentElement.style.display='none'"
            class="w3-button w3-xlarge arm-gray-hover w3-display-topright">&times;</span>
            <h3>Check-in Error</h3>
            <p>Check-in amount must be an integer value.</p>
          </div>

          <div class="w3-responsive">
            <table class="sortable w3-table w3-bordered w3-striped" id="checkout_log">
              <thead class="viper-grey">
                  <th>Date/Time</th>
                  <th>Name</th>
                  <th>Amount</th>
                  <th>Description</th>
                  <th>Check-in</th>
              </thead>
            </table>
          </div>
        </div>
      </div>

    <!-- END PAGE CONTENT -->
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.0/js.cookie.js"></script>
    <script type="text/javascript" src="dist/scripts.js"></script>
    <script src="./dist/bundle.js"></script>
  </body>

<script id="header-table" type="text/template">
    <thead class="viper-grey">
        <th>Name</th>
        <th>Location</th>
        <th>Start Date</th>
    </thead>
</script>

<script id="template-table-entry" type="text/template">
    <tr class="table_entry" id="{{name}}">
      <td class="table_entry_name" id="{{name}}">{{name}}</td>
      <td class="table_entry_location" id="{{location}}">{{location}}</td>
      <td class="table_entry_week" id="{{week}}">{{week}}</td>
    </tr>
</script>
<script>
    var tba = new TBA();

    tba.getRegionals(function(results) {

        // Cache of the template
        var header = document.getElementById("header-table");
        var template = document.getElementById("template-table-entry");
        // Get the contents of the template
        var headerHtml = header.innerHTML;
        var templateHtml = template.innerHTML;
        // Final HTML variable as empty string
        var listHtml = headerHtml;

        // Loop through dataObject, replace placeholder tags
        // with actual data, and generate final HTML
        for (var regional in results) {
          listHtml += templateHtml.replace(/{{name}}/g, results[regional].name)
                                  .replace(/{{location}}/g, results[regional].city + ', ' + results[regional].state_prov + ', ' + results[regional].country)
                                  .replace(/{{week}}/g, results[regional].start_date.replace("2019-",""));
        }

        // Replace the HTML of #list with final HTML
        document.getElementById("regional_table").innerHTML = listHtml;
    });
</script>

</html>